 /** 
{% if Entity['Con-Rol'] %}   * @PreAuthorize("hasRole('{{ Entity['Rol'] }}')")
{% endif %}
   * @Route("/{id}", requirements={"id" = "\d+"})
   * @Method({"POST"})
   * @ParamConverter("{{ Entity['Name'] | lower }}", class="{{ Bundle['Name'] }}:{{ Entity['Name'] }}")
   * @ApiDoc(
   *  description="Edita un/a {{ Entity['Name'] }}"
   * )
   */
  public function updateAction(Request $request, ${{ Entity['Name'] | lower }})
  {

    $validator = $this->get('hades.json_schema.validator');
    $schema = $this->get('hades.json_schema.uri_retriever')->retrieve('file://{{ Bundle['Path'] }}/Schema/{{ Entity['Name'] }}Schema.json');

    $json_request = $validator->isValid(json_decode($request->getContent()), $schema); 

    if (!$json_request) 
    {
        $errors = $validator->getErrors();

        foreach ($errors as $error) 
        {
          $errorMessages[] = (string)$error;
        }

        return new JsonResponse($errorMessages, 400);
    }

    $context = new \JMS\Serializer\DeserializationContext();
    $context->attributes->set('target', ${{ Entity['Name'] | lower }});

    ${{ Entity['Name'] | lower }} = $this->serializer->deserialize($request->getContent(), '{{ Entity['Metadata'].getName() }}', 'json', $context);
    
    $errors = $this->get('validator')->validate(${{ Entity['Name'] | lower }});
    if (count($errors) > 0) 
    {
        foreach ($errors->getIterator() as $error) 
        {
            $errorMessages[] = $error->getMessage();
        }

        return new JsonResponse($errorMessages, 400);
    }

    $this->em->persist(${{ Entity['Name'] | lower}});
    $this->em->flush();

    return new JsonResponse(json_decode($this->serializer->serialize(${{ Entity['Name'] | lower }}, 'json')));
  }